<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to Speech - Shadow Audio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../../styles.css">
</head>

<body class="bg-gray-900 text-white font-sans antialiased overflow-x-hidden">

    <!-- Navbar -->
    <nav
        class="sticky top-0 z-50 glass-effect border-b border-white/5 px-6 py-4 flex items-center justify-between backdrop-blur-md">
        <div class="flex items-center gap-3">
            <a href="../index.html" class="flex items-center gap-2 group">
                <div
                    class="relative w-10 h-10 flex items-center justify-center bg-purple-600/20 rounded-lg border border-purple-500/30 group-hover:border-purple-500/50 transition-all">
                    <i
                        class="fas fa-wave-square text-purple-400 text-xl group-hover:scale-110 transition-transform"></i>
                </div>
                <div>
                    <h1 class="text-xl font-orbitron font-bold tracking-widest text-white">SHADOW<span
                            class="text-purple-500">AUDIO</span></h1>
                    <span class="text-xs text-slate-400 font-mono tracking-wider">GENERATOR</span>
                </div>
            </a>
        </div>
        <a href="../index.html" class="text-slate-400 hover:text-white transition-colors"><i
                class="fas fa-times text-xl"></i></a>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-12 max-w-4xl">
        <div class="text-center mb-10">
            <h2
                class="text-4xl md:text-5xl font-bold font-orbitron mb-4 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">
                Text to Speech</h2>
            <p class="text-slate-400 max-w-2xl mx-auto">Convert written text into lifelike spoken audio using advanced
                synthesis. Select voices, adjust pitch, and control speed.</p>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Controls Panel -->
            <div class="lg:col-span-1 space-y-6">
                <div class="glass p-6 rounded-2xl border border-white/5">
                    <h3 class="text-lg font-bold font-orbitron mb-4 text-purple-400"><i
                            class="fas fa-sliders-h mr-2"></i>Settings</h3>

                    <div class="space-y-4">
                        <div>
                            <label class="block text-xs font-mono text-slate-400 mb-2">VOICE</label>
                            <select id="voice-select"
                                class="w-full bg-black/40 border border-white/10 rounded-lg p-2 text-sm focus:border-purple-500 focus:outline-none transition-colors">
                                <option>Loading voices...</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-xs font-mono text-slate-400 mb-2">RATE (SPEED): <span id="rate-val"
                                    class="text-white">1.0</span></label>
                            <input type="range" id="rate" min="0.5" max="2" value="1" step="0.1"
                                class="w-full accent-purple-500">
                        </div>

                        <div>
                            <label class="block text-xs font-mono text-slate-400 mb-2">PITCH: <span id="pitch-val"
                                    class="text-white">1.0</span></label>
                            <input type="range" id="pitch" min="0.5" max="2" value="1" step="0.1"
                                class="w-full accent-purple-500">
                        </div>

                        <div>
                            <label class="block text-xs font-mono text-slate-400 mb-2">VOLUME: <span id="volume-val"
                                    class="text-white">1.0</span></label>
                            <input type="range" id="volume" min="0" max="1" value="1" step="0.1"
                                class="w-full accent-purple-500">
                        </div>
                    </div>
                </div>

                <div class="glass p-6 rounded-2xl border border-white/5 text-center">
                    <div id="visualizer-container"
                        class="h-24 bg-black/40 rounded-lg border border-white/5 flex items-center justify-center relative overflow-hidden">
                        <div class="absolute inset-0 flex items-center justify-center gap-1 opacity-50" id="bars">
                            <!-- Animated bars via JS -->
                        </div>
                        <i class="fas fa-microphone-lines text-2xl text-purple-500/50 relative z-10"></i>
                    </div>
                </div>
            </div>

            <!-- Input Panel -->
            <div class="lg:col-span-2">
                <div class="glass p-6 rounded-2xl border border-white/5 h-full flex flex-col">
                    <div class="flex items-center justify-between mb-4">
                        <h3 class="text-lg font-bold font-orbitron text-white"><i class="fas fa-keyboard mr-2"></i>Input
                            Text</h3>
                        <button onclick="clearText()"
                            class="text-xs text-red-400 hover:text-red-300 transition-colors uppercase font-mono"><i
                                class="fas fa-trash mr-1"></i>Clear</button>
                    </div>

                    <textarea id="text-input"
                        class="flex-1 w-full bg-black/40 border border-white/10 rounded-xl p-4 text-slate-300 focus:border-purple-500 focus:outline-none transition-colors resize-none mb-6 font-mono text-sm leading-relaxed"
                        placeholder="Type or paste something here to listen..."></textarea>

                    <div class="flex gap-4">
                        <button id="speak-btn"
                            class="flex-1 py-3 bg-purple-600 hover:bg-purple-500 text-white font-bold rounded-xl transition-all shadow-[0_0_20px_rgba(147,51,234,0.3)] hover:shadow-[0_0_30px_rgba(147,51,234,0.5)] flex items-center justify-center gap-2">
                            <i class="fas fa-play"></i> SPEAK
                        </button>
                        <button id="stop-btn"
                            class="px-6 py-3 bg-slate-700 hover:bg-slate-600 text-white font-bold rounded-xl transition-colors disabled:opacity-50"
                            disabled>
                            <i class="fas fa-stop"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        const synth = window.speechSynthesis;
        const textInput = document.getElementById('text-input');
        const voiceSelect = document.getElementById('voice-select');
        const rate = document.getElementById('rate');
        const pitch = document.getElementById('pitch');
        const volume = document.getElementById('volume');
        const speakBtn = document.getElementById('speak-btn');
        const stopBtn = document.getElementById('stop-btn');
        const barsContainer = document.getElementById('bars');

        // Parameter Display Update
        ['rate', 'pitch', 'volume'].forEach(id => {
            document.getElementById(id).addEventListener('input', (e) => {
                document.getElementById(`${id}-val`).textContent = e.target.value;
            });
        });

        // Load Voices
        function loadVoices() {
            const voices = synth.getVoices();
            voiceSelect.innerHTML = '';
            voices.forEach(voice => {
                const option = document.createElement('option');
                option.textContent = `${voice.name} (${voice.lang})`;
                option.setAttribute('data-lang', voice.lang);
                option.setAttribute('data-name', voice.name);
                voiceSelect.appendChild(option);
            });
        }

        loadVoices();
        if (speechSynthesis.onvoiceschanged !== undefined) {
            speechSynthesis.onvoiceschanged = loadVoices;
        }

        // Animation
        function createBars() {
            barsContainer.innerHTML = '';
            for (let i = 0; i < 10; i++) {
                const bar = document.createElement('div');
                bar.className = 'w-1 bg-purple-500 rounded-full transition-all duration-100';
                bar.style.height = '20%';
                barsContainer.appendChild(bar);
            }
        }
        createBars();

        let animInterval;
        function startVisualizer() {
            const bars = barsContainer.children;
            animInterval = setInterval(() => {
                for (let bar of bars) {
                    bar.style.height = Math.random() * 100 + '%';
                }
            }, 100);
        }

        function stopVisualizer() {
            clearInterval(animInterval);
            const bars = barsContainer.children;
            for (let bar of bars) {
                bar.style.height = '20%';
            }
        }

        // Speak Logic
        speakBtn.addEventListener('click', () => {
            if (synth.speaking) {
                console.error('Already speaking...');
                return;
            }
            if (textInput.value !== '') {
                const speakText = new SpeechSynthesisUtterance(textInput.value);

                speakText.onend = e => {
                    stopVisualizer();
                    speakBtn.disabled = false;
                    speakBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    stopBtn.disabled = true;
                };

                speakText.onerror = e => {
                    stopVisualizer();
                    speakBtn.disabled = false;
                    stopBtn.disabled = true;
                };

                const selectedVoice = voiceSelect.selectedOptions[0].getAttribute('data-name');
                const voices = synth.getVoices();
                voices.forEach(voice => {
                    if (voice.name === selectedVoice) {
                        speakText.voice = voice;
                    }
                });

                speakText.rate = rate.value;
                speakText.pitch = pitch.value;
                speakText.volume = volume.value; // Note: not all browsers support volume on utterance

                synth.speak(speakText);
                startVisualizer();

                speakBtn.disabled = true;
                speakBtn.classList.add('opacity-50', 'cursor-not-allowed');
                stopBtn.disabled = false;
            }
        });

        stopBtn.addEventListener('click', () => {
            if (synth.speaking) {
                synth.cancel();
                stopVisualizer();
                speakBtn.disabled = false;
                speakBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                stopBtn.disabled = true;
            }
        });

        function clearText() {
            textInput.value = '';
        }
    </script>
</body>

</html>