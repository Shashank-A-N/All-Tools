<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BPM Tapper - AudioForge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        cyber: {
                            bg: '#05050a',
                            panel: 'rgba(21, 21, 30, 0.6)',
                            primary: '#06b6d4',
                            secondary: '#d946ef',
                            text: '#e2e8f0',
                            muted: '#64748b'
                        }
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    boxShadow: {
                        'neon': '0 0 10px rgba(6, 182, 212, 0.5)',
                        'neon-sec': '0 0 10px rgba(217, 70, 239, 0.5)',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: radial-gradient(circle at 50% 0%, #1e1b4b 0%, #05050a 100%);
            color: white;
        }

        .glass {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .tap-area:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.1);
        }

        @keyframes heartbit {
            0% {
                transform: scale(1);
            }

            5% {
                transform: scale(1.05);
            }

            10% {
                transform: scale(1);
            }
        }

        .beat-anim {
            animation: heartbit 0.2s ease-out;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col font-sans overflow-hidden">

    <header class="h-16 glass z-50 flex items-center justify-between px-6 border-b border-white/5 shrink-0">
        <div class="flex items-center gap-3">
            <div
                class="w-8 h-8 rounded bg-gradient-to-br from-cyber-primary to-cyber-secondary flex items-center justify-center">
                <i class="fas fa-drum text-white text-sm"></i>
            </div>
            <h1 class="text-xl font-bold tracking-tight">AudioForge <span class="text-cyber-primary font-light">BPM
                    Tap</span></h1>
        </div>
        <a href="../index.html" class="text-xs text-cyber-muted hover:text-white transition-colors">
            <i class="fas fa-arrow-left mr-1"></i> Back to Tools
        </a>
    </header>

    <main class="flex-1 flex flex-col items-center justify-center p-6 relative">
        <div class="glass w-full max-w-lg rounded-2xl p-8 flex flex-col gap-8 shadow-2xl items-center text-center">

            <div class="space-y-4">
                <p class="text-cyber-muted text-xs uppercase tracking-widest">Calculated Tempo</p>
                <div id="bpm-display"
                    class="text-8xl md:text-9xl font-mono font-bold text-transparent bg-clip-text bg-gradient-to-br from-white to-cyber-primary leading-none">
                    --
                </div>
                <div class="text-xl text-cyber-secondary font-medium"><span id="avg-text">AVG BPM</span></div>
            </div>

            <div id="tap-btn"
                class="w-48 h-48 rounded-full border-4 border-cyber-primary/30 flex flex-col items-center justify-center cursor-pointer hover:bg-white/5 transition-all select-none tap-area group z-10">
                <i
                    class="fas fa-fingerprint text-4xl text-cyber-primary/50 group-hover:text-cyber-primary transition-colors mb-2"></i>
                <span class="font-bold text-lg tracking-wider">TAP HERE</span>
                <span class="text-xs text-cyber-muted mt-1">Press Spacebar</span>
            </div>

            <button onclick="resetBpm()"
                class="text-cyber-muted hover:text-white text-sm flex items-center gap-2 px-4 py-2 hover:bg-white/5 rounded-lg transition-colors">
                <i class="fas fa-redo-alt"></i> Reset Counter
            </button>

        </div>
    </main>

    <script>
        const bpmDisplay = document.getElementById('bpm-display');
        const tapBtn = document.getElementById('tap-btn');
        const avgText = document.getElementById('avg-text');

        let taps = [];
        const TIMEOUT_MS = 2000; // Reset if no tap for 2s

        function handleTap() {
            const now = Date.now();

            // Auto reset if too much time has passed
            if (taps.length > 0 && now - taps[taps.length - 1] > TIMEOUT_MS) {
                taps = [];
            }

            taps.push(now);

            // Animate
            bpmDisplay.classList.remove('beat-anim');
            void bpmDisplay.offsetWidth; // trigger reflow
            bpmDisplay.classList.add('beat-anim');

            tapBtn.classList.add('border-cyber-primary');
            tapBtn.classList.remove('border-cyber-primary/30');
            setTimeout(() => {
                tapBtn.classList.remove('border-cyber-primary');
                tapBtn.classList.add('border-cyber-primary/30');
            }, 100);

            if (taps.length > 1) {
                calculateBpm();
            } else {
                bpmDisplay.textContent = "--";
                avgText.textContent = "First Tap...";
            }
        }

        function calculateBpm() {
            // Calculate intervals between taps
            let intervals = [];
            for (let i = 1; i < taps.length; i++) {
                intervals.push(taps[i] - taps[i - 1]);
            }

            // Average interval
            const avgInterval = intervals.reduce((a, b) => a + b, 0) / intervals.length;
            const bpm = Math.round(60000 / avgInterval);

            bpmDisplay.textContent = bpm;
            avgText.textContent = "BPM";
        }

        function resetBpm() {
            taps = [];
            bpmDisplay.textContent = "--";
            avgText.textContent = "AVG BPM";
        }

        tapBtn.addEventListener('mousedown', handleTap);
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault(); // prevent scroll
                handleTap();
                // Visual feedback for keyboard
                tapBtn.style.transform = "scale(0.95)";
                setTimeout(() => tapBtn.style.transform = "scale(1)", 100);
            }
        });

    </script>
</body>

</html>